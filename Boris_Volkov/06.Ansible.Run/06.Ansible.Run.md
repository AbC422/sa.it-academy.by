# 06.Ansible.Run

## Display parameters from remote host:

```bash
sneg@home-ubuntu:~$ ansible-playbook first.yaml -i inv.yaml

PLAY [servers] ***************************************************************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************************************************************
Sunday 03 October 2021  14:37:40 +0000 (0:00:00.007)       0:00:00.007 ********
ok: [server1]
ok: [server2]

TASK [Print OS/version] ******************************************************************************************************************************************************************
Sunday 03 October 2021  14:37:47 +0000 (0:00:06.996)       0:00:07.004 ********
ok: [server1] => {
    "msg": "CentOS | 7.9"
}
ok: [server2] => {
    "msg": "Ubuntu | 18.04"
}

TASK [Print Mount/capacity/used] *********************************************************************************************************************************************************
Sunday 03 October 2021  14:37:47 +0000 (0:00:00.030)       0:00:07.035 ********
ok: [server2] => {
    "msg": "Mount point: / Capacity: 21.01 Gb Used: 2.29 Gb"
}
ok: [server1] => {
    "msg": "Mount point: / Capacity: 21.01 Gb Used: 1.86 Gb"
}

TASK [Print RAM/capacity/free] ***********************************************************************************************************************************************************
Sunday 03 October 2021  14:37:47 +0000 (0:00:00.083)       0:00:07.119 ********
ok: [server1] => {
    "msg": "RAM total: 4096 Mb free: 3568 Mb"
}
ok: [server2] => {
    "msg": "RAM total: 4096 Mb free: 3293 Mb"
}

PLAY RECAP *******************************************************************************************************************************************************************************
server1                    : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
server2                    : ok=4    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0

Sunday 03 October 2021  14:37:47 +0000 (0:00:00.043)       0:00:07.162 ********
===============================================================================
Gathering Facts ------------------------------------------------------------------------------------------------------------------------------------------------------------------- 7.00s
Print Mount/capacity/used --------------------------------------------------------------------------------------------------------------------------------------------------------- 0.08s
Print RAM/capacity/free ----------------------------------------------------------------------------------------------------------------------------------------------------------- 0.04s
Print OS/version ------------------------------------------------------------------------------------------------------------------------------------------------------------------ 0.03s
Playbook run took 0 days, 0 hours, 0 minutes, 7 seconds
```

## Playbook for the Ansible user

```bash
sneg@home-ubuntu:~$ ansible-playbook second.yaml -i inv.yaml -e group=servers -e user_to_add=snegok

PLAY [servers] ***************************************************************************************************************************************************************************

TASK [Gathering Facts] *******************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:17 +0000 (0:00:00.007)       0:00:00.007 ********
ok: [server1]
ok: [server2]

TASK [Print variable] ********************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:19 +0000 (0:00:01.653)       0:00:01.660 ********
ok: [server1] => {
    "msg": "You requested user snegok"
}
ok: [server2] => {
    "msg": "You requested user snegok"
}

TASK [Creating user snegok] **************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:19 +0000 (0:00:00.027)       0:00:01.688 ********
ok: [server1]
ok: [server2]

TASK [Check user] ************************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:20 +0000 (0:00:00.667)       0:00:02.355 ********
changed: [server2]
changed: [server1]

TASK [debug] *****************************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:20 +0000 (0:00:00.595)       0:00:02.950 ********
ok: [server1] => {
    "msg": [
        "snegok:x:1001:1001:Managed by ansible:/home/snegok:/bin/bash",
        "Sun Oct  3 15:46:20 UTC 2021"
    ]
}
ok: [server2] => {
    "msg": [
        "snegok:x:1001:1001:Managed by ansible:/home/snegok:/bin/sh",
        "Sun Oct  3 15:46:20 UTC 2021"
    ]
}

TASK [Add SSH-keys to new user] **********************************************************************************************************************************************************
Sunday 03 October 2021  15:46:20 +0000 (0:00:00.046)       0:00:02.997 ********
ok: [server1]
ok: [server2]

TASK [Add to sudoers Ubuntu] *************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:21 +0000 (0:00:00.726)       0:00:03.724 ********
skipping: [server1]
ok: [server2]

TASK [Add to sudoers CentOS] *************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:22 +0000 (0:00:00.661)       0:00:04.386 ********
skipping: [server2]
ok: [server1]

TASK [Check sudoers] *********************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:22 +0000 (0:00:00.535)       0:00:04.921 ********
changed: [server1]
changed: [server2]

TASK [debug] *****************************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:23 +0000 (0:00:00.583)       0:00:05.505 ********
ok: [server1] => {
    "msg": [
        "snegok ALL=(ALL) NOPASSWD: /usr/bin/yum upgrade -y",
        "Sun Oct  3 15:46:23 UTC 2021"
    ]
}
ok: [server2] => {
    "msg": [
        "snegok ALL=(ALL) NOPASSWD: /usr/bin/apt upgrade -y",
        "Sun Oct  3 15:46:23 UTC 2021"
    ]
}

TASK [Test upgrade Ubuntu] ***************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:23 +0000 (0:00:00.046)       0:00:05.552 ********
skipping: [server1]
changed: [server2]

TASK [debug] *****************************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:24 +0000 (0:00:01.078)       0:00:06.630 ********
skipping: [server1]
ok: [server2] => {
    "msg": [
        "Reading package lists...",
        "Building dependency tree...",
        "Reading state information...",
        "Calculating upgrade...",
        "0 upgraded, 0 newly installed, 0 to remove and 0 not upgraded."
    ]
}

TASK [Test upgrade CentOS] ***************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:24 +0000 (0:00:00.041)       0:00:06.672 ********
skipping: [server2]
changed: [server1]

TASK [debug] *****************************************************************************************************************************************************************************
Sunday 03 October 2021  15:46:25 +0000 (0:00:01.088)       0:00:07.761 ********
skipping: [server2]
ok: [server1] => {
    "msg": [
        "Loaded plugins: fastestmirror",
        "Loading mirror speeds from cached hostfile",
        " * base: ftp.agh.edu.pl",
        " * extras: mirror.datacenter.by",
        " * updates: ftp.vectranet.pl",
        "No packages marked for update"
    ]
}

PLAY RECAP *******************************************************************************************************************************************************************************
server1                    : ok=11   changed=3    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0
server2                    : ok=11   changed=3    unreachable=0    failed=0    skipped=3    rescued=0    ignored=0

Sunday 03 October 2021  15:46:25 +0000 (0:00:00.046)       0:00:07.807 ********
===============================================================================
Gathering Facts ------------------------------------------------------------------------------------------------------------------------------------------------------------------- 1.65s
Test upgrade CentOS --------------------------------------------------------------------------------------------------------------------------------------------------------------- 1.09s
Test upgrade Ubuntu --------------------------------------------------------------------------------------------------------------------------------------------------------------- 1.08s
Add SSH-keys to new user ---------------------------------------------------------------------------------------------------------------------------------------------------------- 0.73s
Creating user snegok -------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.67s
Add to sudoers Ubuntu ------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.66s
Check user ------------------------------------------------------------------------------------------------------------------------------------------------------------------------ 0.60s
Check sudoers --------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.58s
Add to sudoers CentOS ------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.54s
debug ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.05s
debug ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.05s
debug ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.05s
debug ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.04s
Print variable -------------------------------------------------------------------------------------------------------------------------------------------------------------------- 0.03s
Playbook run took 0 days, 0 hours, 0 minutes, 7 seconds
```