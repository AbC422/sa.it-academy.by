## Role webserver

### $ ansible-playbook my_web.yaml -i inv.yaml
```bash

PLAY [all_workers] ********************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************
Sunday 15 May 2022  04:26:39 -0700 (0:00:00.025)       0:00:00.025 ************
ok: [host37]
ok: [host38]

TASK [webserver : Include deploy for Debian systems] **********************************************************************************************************************
Sunday 15 May 2022  04:26:41 -0700 (0:00:02.033)       0:00:02.058 ************
skipping: [host37]
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/nginx_deb.yaml for host38

TASK [webserver : Nginx. Install packages] ********************************************************************************************************************************
Sunday 15 May 2022  04:26:41 -0700 (0:00:00.067)       0:00:02.125 ************
ok: [host38]

TASK [webserver : Nginx. Enable and start service] ************************************************************************************************************************
Sunday 15 May 2022  04:26:43 -0700 (0:00:02.222)       0:00:04.348 ************
ok: [host38]

TASK [webserver : Nginx. Deploy debian] ***********************************************************************************************************************************
Sunday 15 May 2022  04:26:44 -0700 (0:00:01.019)       0:00:05.368 ************
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/deploy.yaml for host38 => (item=local-debian1.site)
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/deploy.yaml for host38 => (item=local-debian2.site)

TASK [webserver : Check if directory exists.] *****************************************************************************************************************************
Sunday 15 May 2022  04:26:44 -0700 (0:00:00.057)       0:00:05.425 ************
ok: [host38]

TASK [webserver : Copy index.html] ****************************************************************************************************************************************
Sunday 15 May 2022  04:26:45 -0700 (0:00:00.853)       0:00:06.278 ************
ok: [host38]

TASK [webserver : Add templates conf] *************************************************************************************************************************************
Sunday 15 May 2022  04:26:46 -0700 (0:00:01.199)       0:00:07.477 ************
ok: [host38]

TASK [webserver : Debug] **************************************************************************************************************************************************
Sunday 15 May 2022  04:26:47 -0700 (0:00:01.211)       0:00:08.689 ************
ok: [host38] => {
    "msg": "Virtual host: local-debian1.site"
}

TASK [webserver : Check if directory exists.] *****************************************************************************************************************************
Sunday 15 May 2022  04:26:47 -0700 (0:00:00.037)       0:00:08.726 ************
ok: [host38]

TASK [webserver : Copy index.html] ****************************************************************************************************************************************
Sunday 15 May 2022  04:26:48 -0700 (0:00:00.745)       0:00:09.471 ************
ok: [host38]

TASK [webserver : Add templates conf] *************************************************************************************************************************************
Sunday 15 May 2022  04:26:49 -0700 (0:00:01.206)       0:00:10.677 ************
ok: [host38]

TASK [webserver : Debug] **************************************************************************************************************************************************
Sunday 15 May 2022  04:26:50 -0700 (0:00:01.328)       0:00:12.005 ************
ok: [host38] => {
    "msg": "Virtual host: local-debian2.site"
}

TASK [webserver : Restart nginx debian] ***********************************************************************************************************************************
Sunday 15 May 2022  04:26:51 -0700 (0:00:00.038)       0:00:12.044 ************
changed: [host38]

TASK [webserver : Nginx. Test debian] *************************************************************************************************************************************
Sunday 15 May 2022  04:26:52 -0700 (0:00:00.987)       0:00:13.031 ************
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/test.yaml for host38 => (item=local-debian1.site)
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/test.yaml for host38 => (item=local-debian2.site)

TASK [webserver : Check content to the sites] *****************************************************************************************************************************
Sunday 15 May 2022  04:26:52 -0700 (0:00:00.057)       0:00:13.089 ************
ok: [host38]

TASK [webserver : Debug test] *********************************************************************************************************************************************
Sunday 15 May 2022  04:26:53 -0700 (0:00:00.965)       0:00:14.054 ************
ok: [host38] => {
    "msg": "Virtual host: local-debian1.site"
}

TASK [webserver : Check content to the sites] *****************************************************************************************************************************
Sunday 15 May 2022  04:26:53 -0700 (0:00:00.036)       0:00:14.091 ************
ok: [host38]

TASK [webserver : Debug test] *********************************************************************************************************************************************
Sunday 15 May 2022  04:26:53 -0700 (0:00:00.864)       0:00:14.955 ************
ok: [host38] => {
    "msg": "Virtual host: local-debian2.site"
}

TASK [webserver : Include deploy for RedHat systems] **********************************************************************************************************************
Sunday 15 May 2022  04:26:53 -0700 (0:00:00.025)       0:00:14.981 ************
skipping: [host38]
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/nginx_rh.yaml for host37

TASK [webserver : Install EPEL Repo] **************************************************************************************************************************************
Sunday 15 May 2022  04:26:54 -0700 (0:00:00.060)       0:00:15.041 ************
ok: [host37]

TASK [webserver : Nginx. Install packages] ********************************************************************************************************************************
Sunday 15 May 2022  04:26:54 -0700 (0:00:00.925)       0:00:15.967 ************
ok: [host37]

TASK [webserver : Nginx. Enable and start service] ************************************************************************************************************************
Sunday 15 May 2022  04:26:55 -0700 (0:00:00.891)       0:00:16.859 ************
ok: [host37]

TASK [webserver : Nginx. Deploy centos] ***********************************************************************************************************************************
Sunday 15 May 2022  04:26:56 -0700 (0:00:00.737)       0:00:17.596 ************
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/deploy.yaml for host37 => (item=local-centos1.site)
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/deploy.yaml for host37 => (item=local-centos2.site)

TASK [webserver : Check if directory exists.] *****************************************************************************************************************************
Sunday 15 May 2022  04:26:56 -0700 (0:00:00.046)       0:00:17.643 ************
ok: [host37]

TASK [webserver : Copy index.html] ****************************************************************************************************************************************
Sunday 15 May 2022  04:26:57 -0700 (0:00:00.697)       0:00:18.340 ************
ok: [host37]

TASK [webserver : Add templates conf] *************************************************************************************************************************************
Sunday 15 May 2022  04:26:58 -0700 (0:00:01.031)       0:00:19.372 ************
ok: [host37]

TASK [webserver : Debug] **************************************************************************************************************************************************
Sunday 15 May 2022  04:26:59 -0700 (0:00:01.088)       0:00:20.461 ************
ok: [host37] => {
    "msg": "Virtual host: local-centos1.site"
}

TASK [webserver : Check if directory exists.] *****************************************************************************************************************************
Sunday 15 May 2022  04:26:59 -0700 (0:00:00.029)       0:00:20.490 ************
ok: [host37]

TASK [webserver : Copy index.html] ****************************************************************************************************************************************
Sunday 15 May 2022  04:27:00 -0700 (0:00:00.741)       0:00:21.231 ************
ok: [host37]

TASK [webserver : Add templates conf] *************************************************************************************************************************************
Sunday 15 May 2022  04:27:01 -0700 (0:00:01.070)       0:00:22.301 ************
ok: [host37]

TASK [webserver : Debug] **************************************************************************************************************************************************
Sunday 15 May 2022  04:27:02 -0700 (0:00:01.111)       0:00:23.413 ************
ok: [host37] => {
    "msg": "Virtual host: local-centos2.site"
}

TASK [webserver : Restart nginx centos] ***********************************************************************************************************************************
Sunday 15 May 2022  04:27:02 -0700 (0:00:00.028)       0:00:23.441 ************
changed: [host37]

TASK [webserver : Nginx. Enable firewall port] ****************************************************************************************************************************
Sunday 15 May 2022  04:27:03 -0700 (0:00:00.875)       0:00:24.317 ************
ok: [host37]

TASK [webserver : Nginx. reload service firewalld] ************************************************************************************************************************
Sunday 15 May 2022  04:27:04 -0700 (0:00:01.049)       0:00:25.366 ************
changed: [host37]

TASK [webserver : Nginx. Test centos] *************************************************************************************************************************************
Sunday 15 May 2022  04:27:05 -0700 (0:00:00.945)       0:00:26.312 ************
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/test.yaml for host37 => (item=local-centos1.site)
included: /home/demo/Desktop/ansible.run/roles/webserver/tasks/test.yaml for host37 => (item=local-centos2.site)

TASK [webserver : Check content to the sites] *****************************************************************************************************************************
Sunday 15 May 2022  04:27:05 -0700 (0:00:00.054)       0:00:26.367 ************
ok: [host37]

TASK [webserver : Debug test] *********************************************************************************************************************************************
Sunday 15 May 2022  04:27:06 -0700 (0:00:00.743)       0:00:27.110 ************
ok: [host37] => {
    "msg": "Virtual host: local-centos1.site"
}

TASK [webserver : Check content to the sites] *****************************************************************************************************************************
Sunday 15 May 2022  04:27:06 -0700 (0:00:00.060)       0:00:27.171 ************
ok: [host37]

TASK [webserver : Debug test] *********************************************************************************************************************************************
Sunday 15 May 2022  04:27:06 -0700 (0:00:00.704)       0:00:27.875 ************
ok: [host37] => {
    "msg": "Virtual host: local-centos2.site"
}

PLAY RECAP ****************************************************************************************************************************************************************
host37                     : ok=24   changed=2    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0
host38                     : ok=21   changed=1    unreachable=0    failed=0    skipped=1    rescued=0    ignored=0

Sunday 15 May 2022  04:27:06 -0700 (0:00:00.063)       0:00:27.939 ************
===============================================================================
webserver : Nginx. Install packages -------------------------------------------------------------------------------------------------------------------------------- 2.22s
Gathering Facts ---------------------------------------------------------------------------------------------------------------------------------------------------- 2.03s
webserver : Add templates conf ------------------------------------------------------------------------------------------------------------------------------------- 1.33s
webserver : Add templates conf ------------------------------------------------------------------------------------------------------------------------------------- 1.21s
webserver : Copy index.html ---------------------------------------------------------------------------------------------------------------------------------------- 1.21s
webserver : Copy index.html ---------------------------------------------------------------------------------------------------------------------------------------- 1.20s
webserver : Add templates conf ------------------------------------------------------------------------------------------------------------------------------------- 1.11s
webserver : Add templates conf ------------------------------------------------------------------------------------------------------------------------------------- 1.09s
webserver : Copy index.html ---------------------------------------------------------------------------------------------------------------------------------------- 1.07s
webserver : Nginx. Enable firewall port ---------------------------------------------------------------------------------------------------------------------------- 1.05s
webserver : Copy index.html ---------------------------------------------------------------------------------------------------------------------------------------- 1.03s
webserver : Nginx. Enable and start service ------------------------------------------------------------------------------------------------------------------------ 1.02s
webserver : Restart nginx debian ----------------------------------------------------------------------------------------------------------------------------------- 0.99s
webserver : Check content to the sites ----------------------------------------------------------------------------------------------------------------------------- 0.97s
webserver : Nginx. reload service firewalld ------------------------------------------------------------------------------------------------------------------------ 0.95s
webserver : Install EPEL Repo -------------------------------------------------------------------------------------------------------------------------------------- 0.93s
webserver : Nginx. Install packages -------------------------------------------------------------------------------------------------------------------------------- 0.89s
webserver : Restart nginx centos ----------------------------------------------------------------------------------------------------------------------------------- 0.88s
webserver : Check content to the sites ----------------------------------------------------------------------------------------------------------------------------- 0.86s
webserver : Check if directory exists. ----------------------------------------------------------------------------------------------------------------------------- 0.85s
Playbook run took 0 days, 0 hours, 0 minutes, 27 seconds

```

## Role Testing
### $ ansible-playbook my_test.yaml -i inv.yaml

```bash

PLAY [all_workers] ********************************************************************************************************************************************************

TASK [Gathering Facts] ****************************************************************************************************************************************************
Sunday 15 May 2022  04:20:15 -0700 (0:00:00.012)       0:00:00.012 ************
ok: [host37]
ok: [host38]

TASK [test : Check SUDO with NOPASSWD] ************************************************************************************************************************************
Sunday 15 May 2022  04:20:17 -0700 (0:00:02.136)       0:00:02.148 ************
ok: [host38]
ok: [host37]

TASK [test : Check repos] *************************************************************************************************************************************************
Sunday 15 May 2022  04:20:18 -0700 (0:00:00.772)       0:00:02.920 ************
ok: [host37] => (item=https://deb.debian.org/debian)
ok: [host38] => (item=https://deb.debian.org/debian)
ok: [host37] => (item=https://cloud.centos.org/centos)
ok: [host38] => (item=https://cloud.centos.org/centos)
ok: [host37] => (item=https://pypi.org/simple)
ok: [host38] => (item=https://pypi.org/simple)

TASK [test : Check Docker Hub] ********************************************************************************************************************************************
Sunday 15 May 2022  04:20:27 -0700 (0:00:09.415)       0:00:12.336 ************
ok: [host38]
ok: [host37]

TASK [test : Check Mount point] *******************************************************************************************************************************************
Sunday 15 May 2022  04:20:29 -0700 (0:00:01.367)       0:00:13.703 ************
ok: [host37] => (item={'block_used': 475103, 'uuid': 'N/A', 'size_total': 21003583488, 'block_total': 5127828, 'mount': '/', 'block_available': 4652725, 'size_available': 19057561600, 'fstype': 'ext4', 'inode_total': 1310720, 'options': 'rw,relatime', 'device': '/dev/loop36', 'inode_used': 23499, 'block_size': 4096, 'inode_available': 1287221}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "item": {
        "block_available": 4652725,
        "block_size": 4096,
        "block_total": 5127828,
        "block_used": 475103,
        "device": "/dev/loop36",
        "fstype": "ext4",
        "inode_available": 1287221,
        "inode_total": 1310720,
        "inode_used": 23499,
        "mount": "/",
        "options": "rw,relatime",
        "size_available": 19057561600,
        "size_total": 21003583488,
        "uuid": "N/A"
    },
    "msg": "OK. Available 90.73 % of disk space."
}
ok: [host38] => (item={'mount': '/', 'device': '/dev/loop37', 'fstype': 'ext4', 'options': 'rw,relatime', 'size_total': 21003583488, 'size_available': 18824343552, 'block_size': 4096, 'block_total': 5127828, 'block_available': 4595787, 'block_used': 532041, 'inode_total': 1310720, 'inode_available': 1283885, 'inode_used': 26835, 'uuid': 'N/A'}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "item": {
        "block_available": 4595787,
        "block_size": 4096,
        "block_total": 5127828,
        "block_used": 532041,
        "device": "/dev/loop37",
        "fstype": "ext4",
        "inode_available": 1283885,
        "inode_total": 1310720,
        "inode_used": 26835,
        "mount": "/",
        "options": "rw,relatime",
        "size_available": 18824343552,
        "size_total": 21003583488,
        "uuid": "N/A"
    },
    "msg": "OK. Available 89.62 % of disk space."
}

TASK [test : Check RAM] ***************************************************************************************************************************************************
Sunday 15 May 2022  04:20:29 -0700 (0:00:00.065)       0:00:13.769 ************
ok: [host37] => (item={'block_used': 475103, 'uuid': 'N/A', 'size_total': 21003583488, 'block_total': 5127828, 'mount': '/', 'block_available': 4652725, 'size_available': 19057561600, 'fstype': 'ext4', 'inode_total': 1310720, 'options': 'rw,relatime', 'device': '/dev/loop36', 'inode_used': 23499, 'block_size': 4096, 'inode_available': 1287221}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "item": {
        "block_available": 4652725,
        "block_size": 4096,
        "block_total": 5127828,
        "block_used": 475103,
        "device": "/dev/loop36",
        "fstype": "ext4",
        "inode_available": 1287221,
        "inode_total": 1310720,
        "inode_used": 23499,
        "mount": "/",
        "options": "rw,relatime",
        "size_available": 19057561600,
        "size_total": 21003583488,
        "uuid": "N/A"
    },
    "msg": "All assertions passed"
}
ok: [host38] => (item={'mount': '/', 'device': '/dev/loop37', 'fstype': 'ext4', 'options': 'rw,relatime', 'size_total': 21003583488, 'size_available': 18824343552, 'block_size': 4096, 'block_total': 5127828, 'block_available': 4595787, 'block_used': 532041, 'inode_total': 1310720, 'inode_available': 1283885, 'inode_used': 26835, 'uuid': 'N/A'}) => {
    "ansible_loop_var": "item",
    "changed": false,
    "item": {
        "block_available": 4595787,
        "block_size": 4096,
        "block_total": 5127828,
        "block_used": 532041,
        "device": "/dev/loop37",
        "fstype": "ext4",
        "inode_available": 1283885,
        "inode_total": 1310720,
        "inode_used": 26835,
        "mount": "/",
        "options": "rw,relatime",
        "size_available": 18824343552,
        "size_total": 21003583488,
        "uuid": "N/A"
    },
    "msg": "All assertions passed"
}

PLAY RECAP ****************************************************************************************************************************************************************
host37                     : ok=6    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0
host38                     : ok=6    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0

Sunday 15 May 2022  04:20:29 -0700 (0:00:00.093)       0:00:13.863 ************
===============================================================================
test : Check repos ------------------------------------------------------------------------------------------------------------------------------------------------- 9.42s
Gathering Facts ---------------------------------------------------------------------------------------------------------------------------------------------------- 2.14s
test : Check Docker Hub -------------------------------------------------------------------------------------------------------------------------------------------- 1.37s
test : Check SUDO with NOPASSWD ------------------------------------------------------------------------------------------------------------------------------------ 0.77s
test : Check RAM --------------------------------------------------------------------------------------------------------------------------------------------------- 0.09s
test : Check Mount point ------------------------------------------------------------------------------------------------------------------------------------------- 0.07s
Playbook run took 0 days, 0 hours, 0 minutes, 13 seconds

```
